\section{Background and Related Work}

The input to the workflow we propose is a segmented image, or ``image mask.''
Image segmentation is the process of partitioning a 3D cuboidal array of cells, or voxels, into non-overlapping regions corresponding to different tissues or materials.  The raw CT or MRI image consists of intensity values for each voxel; noise and artifacts are generally expected to be present in these images.  The image segmentation process seeks to assign two or more discrete ``colors'' to the voxels based on the intensity values.  Among the main segmentation techniques are thresholding, level set methods~\cite{malladi_1995, sethian_1996}, and machine-learning-based approaches~\cite{litjens_2017}.  Our present focus is on binary image masks wherein two colors are envisaged, one indicating material and the other void.  In most applications, smoothing, filtering, and resampling under expert manual control are required to achieve the best results.

This article proposes a process for creating a facetized b-rep from a noisy image mask, as a precursor to the generation of a volumetric mesh (e.g. finite elements) to support physics-based simulation.  The b-rep's facets must generally register with the finite elements (or other) of the mesh.  Automatic unstructured tet meshing beginning with a triangulated b-rep can be accomplished via advancing-front-type methods \cite{jin_1993, lohner_1988} or by Delaunay tetrahedralization \cite{lohner_1997}. For example, Updegrove \textit{et al.}~\cite{updegrove_2016} used unstructured tetrahedral meshing on surfaces created from \textit{lofting} a series of 2D segmentations. Lofting is known as a 2.5D approach because stacked contours of neighboring slices cannot capture arbitrary 3D geometry; most modern approaches treat the mask as a three-dimensional object to avoid this drawback.

Young \textit{et al.}~\cite{young_2008} used a \textit{direct meshing} approach to generate meshes from multi-material image masks, without the intermediate step of creating a surface mesh. They combined the surface generation and mesh generation stages into one process via their \textit{enhanced volumetric marching cubes} approach.  The authors extended their volumetric algorithm to handle intersections of up to eight regions in one grid cell -- the maximum number of intersections that can occur for a Cartesian grid.  The resulting mesh is \textit{mixed hex-tet}, with hexahedra in the form of the original voxels on the interior, tetrahedra near boundaries, and pyramids where needed to transition from hexes to tets. The authors also utilized partial volume-based interpolation to improve surface smoothness. Additional efforts to reduce the mesh size were made by performing an octree-based approach to collect neighboring interior hexahedral elements into larger elements.  The result is nevertheless a surface mesh that is very fine, which constrains the size of interior elements in the volume mesh.  Indeed, the default and recommended procedure in their software \textit{Simpleware} (known as \textit{+FE Free}) is to follow the two-step paradigm of b-rep generation followed by CAD-based volumetric meshing as described previously. Specifically, the software extracts the surfaces from the extended volumetric marching cubes step, performs multi-part decimation and smoothing~\cite{egst}, and finally uses a conventional CAD-based tetrahedral mesher to generate fully tetrahedral meshes from the facetized b-rep.

More broadly, many image-based volumetric meshing approaches rely on the \textit{marching cubes} algorithm~\cite{lorensen_1987} and its variants for purposes of the image-mask-to-b-rep step.  (The first two of the three comparison techniques described in \figref{flowchart} incorporate marching-cubes variants.)  Marching cubes assumes the existence of an implicit isosurface, which can be defined on the voxel grid taken as a structured hex mesh.  Triangular patches are generated to approximate the intersection of this isosurface with each grid cell; the triangles are then connected together to form a continuous surface. B-reps generated via marching cubes generally exhibit fairly strong aliasing, thus smoothing is often applied to the surface mesh (the proposed method will also be subject to aliasing, although significantly less so, as will be shown in section \ref{sec:Performance Assessment}). Ideally, the smoothing technique attempts to preserve the volume, as with HC Laplacian smoothing\cite{vollmer_1999} and Taubin smoothing \cite{taubin1995signal, taubin_1995}.  As first proposed, the MC algorithm was applicable only to binary image masks, but has since been extended to multi-material images.  See \cite{newman2006} for a review and further references.

Variations and enhancements of MC have been proposed that seek to preserve sharp features while retaining other favorable properties.  Labsik \textit{et al.} \cite{labsik_2002} extracted a coarse surface using marching cubes, followed by iterative remeshing to finer resolutions where features are detected.  Kobbelt \textit{et al.} \cite{kobbelt_2001} modified standard MC in two ways:  enhancing the discrete distance field that defines the underlying isosurface, and adding supplemental sampling points to detect edges and corners. Depending on the application, though, surface smoothness, and in particular diminished aliasing, may well be more important than sharp-feature preservation. Lempitsky \cite{lempitsky_2010}, for example, enforced higher-order smoothness by modifying the isosurface function and solving a convex quadratic optimization problem for each grid cell.

Meyer \textit{et al.}~\cite{meyer_2008} employed a \textit{particle-based sampling} technique for multi-material volumes. Surface samples (called \textit{particles}) are constrained to the zero set of an implicit function. The distances between particles are locally adapted to create higher densities of points near surface features. A Delaunay tetrahedralization of the sampling points is computed, and each tetrahedron is assigned a material label. The surface mesh is generated by extracting the faces bounded by tetrahedra with different material labels. Finally, a conventional CAD-based tetrahedral mesher is employed to produce an analysis-ready mesh. The approach faithfully and robustly captures the geometries of complex material interfaces. However, the authors report impractically long run times.
Examples of other image-based meshing techniques include \cite{fang_2009, mohamed_2004, jermyn_2013, boissonnat_2009}.

In the matter of explicit b-rep creation from noisy discrete data, two key features can be cited:  one concerns the type or nature of the discrete input; and the other, the extent of noise in the input that can be tolerated, and its effects on the output b-rep.  Our workflow takes as input a segmented image that generally contains miscolored voxels.  As such, the topology of the ``literal'' image is generally distinct from that of the desired, smoothed 3D domain.  This is a somewhat subtle but important departure from the classical problem of surface reconstruction, which generally assumes the {\em existence} of a surface that is sampled -- though perhaps with noise -- by the input points.  The classical problem has been extensively treated.  In an important early work by Amenta \textit{et al.}~\cite{amenta2000}, a point set strictly on an assumed closed and manifold surface forms the input, while the output is a Delaunay triangulation of the input points.  This work is notable for the theoretical guarantees it presents, although there are requirements on the point density that are often difficult to achieve in practice, particularly near sharp features.  In Boltcheva \textit{et al.}'s work~\cite{boltcheva2017}, the input is again a clean point cloud, but the surface is reconstructed by restricting the Voronoi diagram of the points to a collection of disks centered on the input points instead of by Delaunay triangulation.

Among the most widely-used surface reconstruction algorithms for binary images are the \textit{Power Crust} and \textit{Poisson surface reconstruction} techniques. Amenta \textit{et al.} \cite{amenta_2001} presented the Power Crust algorithm for reconstructing watertight surfaces from unoriented point clouds. The algorithm first estimates the \textit{medial axis transform} from the point cloud, which consists of the locus of centers of maximal balls completely contained in the interior of the surface, together with the radius function. The algorithm then applies an inverse transform to approximate the medial axis and produce a piecewise-linear surface. The Power Crust algorithm relies on fairly dense point distributions for good performance (which the proposed method indeed produces). Kazhdan \textit{et al.} presented the \textit{Poisson surface reconstruction} \cite{kazhdan_2008} and subsequently the \textit{screened Poisson surface reconstruction} \cite{kazhdan_2013} algorithms for oriented point clouds. They compute an indicator function defined as unity for points inside the surface and zero for points outside, whose gradient approximates the vector field defined by the oriented point cloud. The indicator function is governed by a Poisson problem, which is typically solved on the grid of voxel vertices.  With the indicator function in hand, marching cubes is invoked to recover a polygonized surface.  The \textit{screened} variant introduces a soft constraint that encourages the reconstructed isosurface to pass through the input points. In practice, the screened approach is more robust than the original Poisson approach in generating manifold surfaces from complex point clouds. The technique produces smooth surfaces that exhibit resiliency to noise, outliers, and undersampling.

Other point-cloud-based techniques seek specifically to address the presence of noise in the point cloud.  If noise is present, obviously a strict interpolation of the input points is not appropriate.  In Fleishman \textit{et al.}~\cite{fleishman2005}, moving-least-squares approximation is used to construct projections of the input points onto smooth patches, where the points for any given patch are selected using an innovative statistical method.  The MLS-based projection is similar to that proposed in \cite{levin2004}, but is applied patchwise instead of globally.  This raises the possibility of capturing sharp features. Dey and Goswami~\cite{dey2003} proposed a ``tight cocone'' method for fixing surfaces that have holes due to localized insufficient point density.  This algorithm produces an interpolating surface via Delaunay triangulation without introducing additional points.  In a further development~\cite{dey2011}, a variant of the cocone algorithm is applied to collections of local patches to reduce memory requirements.  Many other surface-reconstruction approaches exist, including those making use of Voronoi tessellation and variational methods~\cite{berger}.

Coeurjolly \textit{et al.}~\cite{coeurjolly2021} consider multi-colored segmented-image inputs instead of point clouds.  Their algorithm seeks to recover a smooth b-rep from the stepped one composed of the input image mask's surfels.  This is done by moving surfel vertices under the control of a quadratic minimum problem.  The quadratic function measures the departure of the final facet normals from separately-computed smooth ideal values.  The result is topologically identical to the stepped b-rep; this algorithm is therefore not ideal when image pollution in the form of arbitrary miscolored voxels cannot be ruled out.  But in the absence of such pollution, the results are visually pleasing.  Boltcheva \textit{et al.}~\cite{boltcheva2009} also consider multi-colored image masks, with particular emphasis on preservation of zero- and one-dimensional junctions where multiple colors meet.  Their algorithm extracts these junctions from the segmented image and then invokes Delaunay refinement~\cite{pons2007} to construct a b-rep or a tetrahedral volume mesh that strictly preserves the junctions.  As with~\cite{coeurjolly2021}, the approach is suitable when the topology of the segmented image is clean, and should therefore be preserved in the output b-rep.

Berge \textit{et al.}~\cite{berge2019} provide an example of Voronoi-based surface and volume meshing given data that defines free surfaces and material interfaces.  In this work, intersecting planes and cylindrical features must be known analytically as the starting point. The objective of their algorithm is to select Voronoi sites so that point- and line-intersections, as well as surface patches, that are present in the input are reproduced as Voronoi vertices, edges, and facets, respectively.  As a mechanism for surface reconstruction, the Voronoi formalism has some nice features:  watertightness is guaranteed for any distribution of site locations, and the facets are always planar and convex.  And, there is the potential for capturing sharp features in a natural way.  For these reasons, we employ Voronoi as a step in our b-rep creation algorithm.