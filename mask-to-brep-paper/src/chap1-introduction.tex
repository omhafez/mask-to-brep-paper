\section{Introduction}

Image-based modeling and simulation is becoming an increasingly important analytic and predictive tool for a variety of medical and engineering applications. Some examples include patient-specific diagnosis and treatment, large-scale \textit{in silico} trials, medical device design, computer-assisted surgery, and as-built analysis of existing parts. Whereas traditional physics-based modeling and simulation typically uses NURBS-based surfaces generated from CAD software to define geometries of interest, the image-based analog extracts geometries from imaging data, typically in the form MRI or CT. The field of image-based modeling and simulation covers a broad spectrum of topics, including image processing, computational geometry, numerical methods, and continuum mechanics. The workflow entails: image acquisition, image segmentation, image-based mesh generation, and finally the application of interest. This paper focuses on one component of the image-based meshing step, namely: surface generation. The other steps are briefly mentioned below, but otherwise the focus shall remain on surface generation from a segmented image. \\ \\
%
Medical imaging is the process of generating discrete image representations of the regions of interest. For our purposes, the acquired image provides a three-dimensional rectilinear grid of point intensity values as input to the rest of the workflow. In the case of MRI, those values are weighted proton densities, which effectively measure water-content. In the case of CT, they are attenuation measurements from an x-ray beam source, which effectively measure density. For typical applications, we can expect millimeter resolution, and in some cases even better~\cite{van2012super}.\\ \\
%
Image segmentation is the process of partitioning an image into non-overlapping regions corresponding to different tissues or objects in an image. Contrast differences between neighboring tissues can be difficult to identify due in part to noise and artifacts, and thus image processing in the form of smoothing, filtering, and resampling are performed to improve the effectiveness of the image segmentation technique. The output from image segmentation consists of one or more \textit{image masks}, depending on how many regions of interest exist in the field of view. If there is only one region of interest, the output is termed a \textit{binary image mask}. A few popular techniques in image segmentation include simple thresholding, level set methods~\cite{malladi_1995, sethian_1996}, machine learning-based approaches~\cite{litjens_2017}, and often in practical cases, manual fine-tuning.\\ \\
%
Image-based meshing is the process of generating explicitly defined volume meshes from imaging data. For our purposes, we focus on generating meshes specifically from segmented image data. The challenge is to define the mesh explicitly in terms of vertex coordinates, corresponding polytopes, and the connectivity of those polytopes, as opposed to an implicit definition of the volume enclosed by the zero-set of a 4D indicator function. Image-based meshing is often separated into two steps: 1) surface generation, and 2) conventional CAD-based volume meshing. Surface generation (or surface extraction) is a matter of generating a watertight, manifold \textit{boundary representation} (or \textit{b-rep}). B-reps may refer to polygonized surface meshes or NURBS surfaces; for our purposes we will restrict the scope to surface meshes. \\ \\
%
Various approaches have been pursued to tackle image-based meshing, most of which are extensions of the \textit{marching cubes} algorithm~\cite{lorensen_1987}. It assumes an implicit isosurface exists whose associated volume is the union of voxels in an image mask that belong to the same region. Triangular patches are generated to approximate the intersection of this isosurface with each grid cell and are combined to form a continuous surface. The two most glaring limitations of the marching cubes algorithm are that 1) the resulting surfaces exhibit aliasing artifacts that poorly capture smooth and sharp features alike, and 2) the algorithm is limited to surface generation from binary masks (i.e., it cannot generate surfaces for multi-material masks). Advances in the field of image-based meshing have mostly focused on modifications to the marching cubes algorithm to address these two limitations - namely, 1) generating smooth surfaces that represent the original object accurately while preserving sharp features; and 2) generating quality surface meshes for general multi-material image masks. \\ \\ 
%
Updegrove \textit{et al.}~\cite{updegrove_2016} used a \textit{lofting} technique on a series of 2D segmentations to generate models of blood vessels. An approximate centerline must be drawn, and 2D segmentations are combined using spline interpolating functions to generate surfaces. Unstructured tetrahedral meshes are then generated from the surfaces. Lofting is known as a 2.5D approach because stacking contours of neighboring slices cannot capture arbitrary 3D topologies. The approach often suffers from significant loss of accuracy, and the interpolating splines typically require manual selection of control points~\cite{young_2008}. Treating an image mask as a series of 2D masks was a popular approach in past decades, but most modern approaches treat it as a three-dimensional object to avoid the drawbacks of lofting techniques. \\ \\
%
Young \textit{et al.}~\cite{young_2008} used a \textit{direct meshing} approach to generate meshes from multi-material image masks without the intermediate step of creating a surface mesh. Young \textit{et al.} combined the surface generation and mesh generation stages into one process via their \textit{enhanced volumetric marching cubes} approach. Standard volumetric marching cubes generates tetrahedral volumes from the intersection of the isosurface with grid cells, rather than just triangular surface patches. The authors extended the volumetric algorithm to handle intersections of up to eight regions in one grid cell - the maximum number of intersections that can occur for a Cartesian grid. The resulting mesh is \textit{mixed hex-tet}, where tetrahedra exist near the surface based on the extended volumetric marching cubes approach; internal voxels are converted directly to hexahedra; and pyramidal and tetrahedral elements exist in the transitional layer in between. The authors also utilized partial volume-based interpolation to improve surface smoothness. Additional efforts to reduce the mesh size were made by converting surface tetrahedra to hexahedra where appropriate, and by performing an octree-based approach to collect neighboring interior hexahedral elements into larger elements. Nonetheless, this \textit{grid-based} approach results in a surface mesh that is very fine, which subsequently constrains the size of interior elements in the volume mesh. The resulting mesh from this approach yields an intractably large number of degrees of freedom for simulation purposes. Thus, for practical purposes, the number of points and polyhedra defining the surface must be reduced (or \textit{decimated}), to allow for a subsequent coarser volumetric discretization. Indeed, the default and recommended approach in their software \textit{Simpleware} (known as \textit{+FE Free}) is to follow the two-step paradigm of surface generation followed by CAD-based meshing as described previously. Namely, the software extracts the resulting surface following the extended volumetric marching cubes step, performs multi-part decimation and smoothing~\cite{egst}, and finally uses a conventional CAD-based tetrahedral mesher to generate fully tetrahedral meshes from the polygonized surfaces. \\ \\
%
Meyer \textit{et al.}~\cite{meyer_2008} employed a \textit{particle-based sampling} technique for multi-material volumes. Surface samples (called \textit{particles}) are constrained to the zero-set of an implicit function. The distances between particles are locally adapted to create higher densities of points near surface features. A Delaunay tetrahedralization of the sampling points is computed, and each tetrahedron is assigned a material label. The surface mesh is generated by extracting the faces bounded by tetrahedra with different material labels. Finally, a conventional CAD-based tetrahedral mesher is once again employed to produce an analysis-ready mesh. The approach faithfully and robustly captures the geometries of complex material interfaces, but has debilitating performance issues, even by the own admission of the authors. \\ \\
%
A number of other techniques have been published on the topic of image-based meshing, often attacking the problem from completely different perspectives~\cite{bronson_2014,fang_2009,boissonnat_2009,zhao_2016}. Although several of the works presented here attempt to generate surfaces for multi-material image masks, a great deal of effort and applicability still exists for generating high-quality surfaces (and resulting meshes) from binary image masks. This will be the focus of the paper, as we propose a novel Voronoi-based surface generation approach that guarantees watertightness and lays out a framework that has the potential to ultimately reconstruct a wider array of boundaries, including those with sharp edges or corners. The method is also simple to use, freeing the user from a complicated set of parameters that need to be modified for optimal results. \\ \\
%
Provided a triangulated surface mesh from any of the aforementioned approaches, conventional CAD-based volume-meshing techniques are utilized to produce a final volume mesh. Since a general automatic hexahedral meshing algorithm has yet to be developed, tetrahedral meshing is usually the method of choice for arbitrary input surfaces. The two most widely adopted approaches for automated unstructured tetrahedral mesh generation are \textit{advancing front}~\cite{jin_1993, lohner_1988} and \textit{Delaunay tetrahedralization}~\cite{lohner_1997}. \\ \\
%
Finally, applications for this work range from 3D printing to visualization to finite element analysis (FEA). In the case of 3D printing and visualization, b-reps can be used for surgery planning, custom surgical guides and implants, rapid prototyping, and generation of CAD surfaces from existing parts. Meanwhile, image-based simulation has been performed on nearly every major organ in the body and shows great promise in advancing both personalized medicine~\cite{neal2010current} and large-scale clinical trials~\cite{viceconti2016silico}. In addition, image-based simulation offers the ability to perform non-destructive analysis on as-built engineering parts or legacy parts whose CAD may not be available~\cite{bradley2005advances}.\\ \\
%
Given the context of the image-based modeling and simulation workflow within which it fits, the novel Voronoi-based surface generation method is now proposed herein. The algorithm is followed by a performance assessment in comparison to a state-of-the-art commercial software, which are made for a variety of canonical cases as well as for cases from real MRI and CT data. The paper is closed with a summary and discussion of future directions for this work.
